<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Application Bundles &mdash; helloSystem  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/theme_overrides.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Global Menu" href="menu.html" />
    <link rel="prev" title="Applications" href="applications.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            helloSystem
              <img src="../_static/hello_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/components.html">Getting to know the system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/feedback.html">Providing feedback</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reviewer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reviewer/guide.html">Reviewer Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ux-guidelines.html">User Experience Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="boot.html">Boot process</a></li>
<li class="toctree-l1"><a class="reference internal" href="geom_rowr.html">geom_rowr kernel module</a></li>
<li class="toctree-l1"><a class="reference internal" href="graphics.html">Graphics hardware autoconfiguration</a></li>
<li class="toctree-l1"><a class="reference internal" href="binary-compatibility.html">Binary Compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="applications.html">Applications</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Application Bundles</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#benefits">Benefits</a></li>
<li class="toctree-l2"><a class="reference internal" href="#application-bundle-formats">Application bundle formats</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#app-bundles"><code class="docutils literal notranslate"><span class="pre">.app</span></code> bundles</a></li>
<li class="toctree-l3"><a class="reference internal" href="#appdir-bundles"><code class="docutils literal notranslate"><span class="pre">.AppDir</span></code> bundles</a></li>
<li class="toctree-l3"><a class="reference internal" href="#wrappers-for-legacy-packages">Wrappers for legacy packages</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#building-application-bundles">Building application bundles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#making-an-application-load-privately-bundled-libraries">Making an application load privately bundled libraries</a></li>
<li class="toctree-l3"><a class="reference internal" href="#avoiding-absolute-paths">Avoiding absolute paths</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#credits">Credits</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="menu.html">Global Menu</a></li>
<li class="toctree-l1"><a class="reference internal" href="filer-context-menus.html">Extending Filer context menus</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer-tools.html">Developer Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="midi.html">MIDI</a></li>
<li class="toctree-l1"><a class="reference internal" href="specifications.html">Specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="building.html">Building the Live ISO</a></li>
<li class="toctree-l1"><a class="reference internal" href="monkey-patch.html">Monkey Patching</a></li>
<li class="toctree-l1"><a class="reference internal" href="tracing.html">Tracing with DTrace/dtruss</a></li>
<li class="toctree-l1"><a class="reference internal" href="localization.html">Localization</a></li>
<li class="toctree-l1"><a class="reference internal" href="ports.html">Working with FreeBSD Ports</a></li>
<li class="toctree-l1"><a class="reference internal" href="base.html">Working with the FreeBSD base system</a></li>
<li class="toctree-l1"><a class="reference internal" href="man.html">Writing man pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="rpi.html">Raspberry Pi</a></li>
<li class="toctree-l1"><a class="reference internal" href="linux.html">Building on Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributions.html">Note to distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">helloSystem</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Application Bundles</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/helloSystem/docs/blob/main/developer/application-bundles.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="application-bundles">
<h1>Application Bundles<a class="headerlink" href="#application-bundles" title="Permalink to this heading"></a></h1>
<p>helloSystem uses <strong>application bundles</strong> to manage native applications. Whenever possible, application bundles are used. XDG-style <code class="docutils literal notranslate"><span class="pre">.desktop</span></code> files are considered legacy and should be avoided.</p>
<div class="section" id="benefits">
<h2>Benefits<a class="headerlink" href="#benefits" title="Permalink to this heading"></a></h2>
<p>Applications shipped as application bundles can</p>
<ul class="simple">
<li><p>Easily be moved around in the filesystem (relocation)</p></li>
<li><p>Easily be copied to e.g., another machine or a network share</p></li>
<li><p>Easily be copied on the local machine to get a second instance of the same application (e.g., to make changes to it while keeping the original around)</p></li>
<li><p>Easily be deleted by moving to the Trash</p></li>
<li><p>Easily be managed without the need for a package manager</p></li>
<li><p>Easily be modified (e.g., changing the icon) without any side effects to other parts of the system</p></li>
<li><p>Easily be distributed (e.g., in archives like zip files or in disk images) without the need for packaging</p></li>
<li><p>Easily be understood by switchers coming from other operating systems with similar application distribution formats</p></li>
</ul>
</div>
<div class="section" id="application-bundle-formats">
<h2>Application bundle formats<a class="headerlink" href="#application-bundle-formats" title="Permalink to this heading"></a></h2>
<div class="section" id="app-bundles">
<h3><code class="docutils literal notranslate"><span class="pre">.app</span></code> bundles<a class="headerlink" href="#app-bundles" title="Permalink to this heading"></a></h3>
<p>helloSystem supports simplified GNUstep-style <code class="docutils literal notranslate"><span class="pre">.app</span></code> bundles.</p>
<p>Minimal requirements:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>./Application.app
./Application.app/Application &lt;-- (link to) the executable to be launched when Application.app is double clicked
./Application.app/Resources/Application.png &lt;-- the application icon (png format)
./Application.app/Resources/can-open &lt;-- optional, MIME types the application can open, separated by `;`
</pre></div>
</div>
<p>In order to realize the full intended functionality, additional metadata may be required (such as localized application name, version, supported file formats, etc.). Possibly the GNUstep metadata format is sufficient for this.</p>
</div>
<div class="section" id="appdir-bundles">
<h3><code class="docutils literal notranslate"><span class="pre">.AppDir</span></code> bundles<a class="headerlink" href="#appdir-bundles" title="Permalink to this heading"></a></h3>
<p>helloSystem supports simplified ROX-style <code class="docutils literal notranslate"><span class="pre">.AppDir</span></code> bundles.</p>
<p>Minimal requirements:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>./Application.AppDir
./Application.AppDir/AppRun &lt;-- (link to) the executable to be launched when Application.app is double clicked
./Application.AppDir/.DirIcon &lt;-- the application icon (png format)
</pre></div>
</div>
<p>In order to realize the full intended functionality, additional metadata may be required (such as localized application name, version, supported file formats, etc.). Possibly the ROX AppDir specification is not sufficient for this and may need to be amended (to be determined).</p>
</div>
<div class="section" id="wrappers-for-legacy-packages">
<h3>Wrappers for legacy packages<a class="headerlink" href="#wrappers-for-legacy-packages" title="Permalink to this heading"></a></h3>
<p>helloSystem supports applications that are not shipped in bundle formats yet. These can be bridged by <strong>wrapper bundles</strong>, application bundles that merely launch (but do not contain) the payload application (which may be installed in traditional ways).</p>
<p>A <strong>desktop2app</strong> tool ships with helloSystem that automates the creation of such wrappers.</p>
<p>Please note that the use of wrapper bundles is discouraged and is only available as a bridge technology for backward compatibility with existing application packages.</p>
</div>
</div>
<div class="section" id="building-application-bundles">
<h2>Building application bundles<a class="headerlink" href="#building-application-bundles" title="Permalink to this heading"></a></h2>
<p>Here is a real-world example on how to build an application bundle for a Qt application written in C++ using GitHub and <a class="reference external" href="https://cirrus-ci.com/">Cirrus CI</a>:</p>
<p>https://github.com/helloSystem/QHexEdit</p>
<p>The application gets compiled and uploaded in a fully automated process.</p>
<p>The resulting application bundle is provided for download in zipped form on GitHub Releases.</p>
<p>Please see the <a class="reference external" href="https://github.com/helloSystem/QHexEdit/blob/main/.cirrus.yml"><code class="docutils literal notranslate"><span class="pre">.cirrus.yml</span></code></a> file for details.</p>
<div class="section" id="making-an-application-load-privately-bundled-libraries">
<h3>Making an application load privately bundled libraries<a class="headerlink" href="#making-an-application-load-privately-bundled-libraries" title="Permalink to this heading"></a></h3>
<p>If an application is supposed to load privately bundled libraries, one must patch it so that it loads privately bundled libraries from a path relative to itself (<code class="docutils literal notranslate"><span class="pre">$ORIGIN</span></code>) rather than from <code class="docutils literal notranslate"><span class="pre">/usr/local/lib</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sed<span class="w"> </span>-i<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s|/usr/local/lib|$ORIGIN/../lib|g&#39;</span><span class="w"> </span>usr/local/bin/falkon
<span class="gp">$ </span>ln<span class="w"> </span>-s<span class="w"> </span>usr/local/lib<span class="w"> </span>.
<span class="gp">$ </span>rm<span class="w"> </span>usr/local/bin/falkon-e
</pre></div>
</div>
<p>This works because by coincidence the string <code class="docutils literal notranslate"><span class="pre">/usr/local/lib</span></code> has the exact same length as <code class="docutils literal notranslate"><span class="pre">$ORIGIN/../lib</span></code>. If this was not the case, one would need to either specify the rpath at compilation time, or use a tool such as <code class="docutils literal notranslate"><span class="pre">patchelf</span></code>.</p>
</div>
<div class="section" id="avoiding-absolute-paths">
<h3>Avoiding absolute paths<a class="headerlink" href="#avoiding-absolute-paths" title="Permalink to this heading"></a></h3>
<p>For an application to be fully relocatable in the filesystem, one must take care that no absolute paths to data files (e.g., those in <code class="docutils literal notranslate"><span class="pre">/usr/share/&lt;APPNAME&gt;</span></code> get compiled in.</p>
<p>In Qt applications, void <a class="reference external" href="http://doc.qt.io/qt-5/qstandardpaths.html"><code class="docutils literal notranslate"><span class="pre">QStringList</span> <span class="pre">QStandardPaths::standardLocations(QStandardPaths::AppDataLocation);</span></code></a>. According to the <a class="reference external" href="http://doc.qt.io/qt-5/qstandardpaths.html">Qt documentation</a>, this resolves to <code class="docutils literal notranslate"><span class="pre">&quot;~/.local/share/&lt;APPNAME&gt;&quot;,</span> <span class="pre">&quot;/usr/local/share/&lt;APPNAME&gt;&quot;,</span> <span class="pre">&quot;/usr/share/&lt;APPNAME&gt;&quot;</span></code> but clearly <code class="docutils literal notranslate"><span class="pre">/usr</span></code> is not where these things are located in an <code class="docutils literal notranslate"><span class="pre">.app</span></code> bundle.</p>
<p>Instead, use <a class="reference external" href="http://doc.qt.io/qt-5/qcoreapplication.html#applicationDirPath"><code class="docutils literal notranslate"><span class="pre">QString</span> <span class="pre">QCoreApplication::applicationDirPath()</span></code></a> and construct a <em>relative</em> path to <code class="docutils literal notranslate"><span class="pre">../share/&lt;APPNAME&gt;</span></code> from there.</p>
<p>For an example, see:
https://github.com/KaidanIM/Kaidan/commit/da38011b55a1aa5d17764647ecd699deb4be437f</p>
</div>
</div>
<div class="section" id="credits">
<h2>Credits<a class="headerlink" href="#credits" title="Permalink to this heading"></a></h2>
<p>Application directories and application bundles have been used by many desktop-oriented operating systems, including RISC OS, NeXTStep/OPENSTEP, Mac OS X, and various other systems. Classic Macintosh System used single-file applications that kept resources in the Resource Fork.</p>
<ul class="simple">
<li><p>https://en.wikipedia.org/wiki/Application_directory</p></li>
<li><p>http://rox.sourceforge.net/desktop/AppDirs.html</p></li>
<li><p>https://en.wikipedia.org/wiki/Resource_fork</p></li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="applications.html" class="btn btn-neutral float-left" title="Applications" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="menu.html" class="btn btn-neutral float-right" title="Global Menu" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>