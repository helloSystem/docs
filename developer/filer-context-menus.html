<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Extending Filer context menus &mdash; helloSystem  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/theme_overrides.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Developer Tools" href="developer-tools.html" />
    <link rel="prev" title="Global Menu" href="menu.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            helloSystem
              <img src="../_static/hello_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/components.html">Getting to know the system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/feedback.html">Providing feedback</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reviewer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reviewer/guide.html">Reviewer Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ux-guidelines.html">User Experience Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="boot.html">Boot process</a></li>
<li class="toctree-l1"><a class="reference internal" href="geom_rowr.html">geom_rowr kernel module</a></li>
<li class="toctree-l1"><a class="reference internal" href="graphics.html">Graphics hardware autoconfiguration</a></li>
<li class="toctree-l1"><a class="reference internal" href="binary-compatibility.html">Binary Compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="applications.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="application-bundles.html">Application Bundles</a></li>
<li class="toctree-l1"><a class="reference internal" href="menu.html">Global Menu</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Extending Filer context menus</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#an-example-of-an-action">An example of an action</a></li>
<li class="toctree-l3"><a class="reference internal" href="#an-example-of-a-menu">An example of a menu</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#desktop-file">Desktop file</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#desktop-file-format">Desktop file format</a></li>
<li class="toctree-l3"><a class="reference internal" href="#desktop-file-identifier">Desktop file identifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="#desktop-files-search-path">Desktop files search path</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#managed-objects">Managed objects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#actions-and-profiles">Actions and profiles</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menus">Menus</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conditions">Conditions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#action-definition">Action definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#profile-definition">Profile definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#menu-definition">Menu definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">Conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#parameters">Parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#parameters-expansion">Parameters expansion</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multiple-execution">Multiple execution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#building-the-whole-hierarchy">Building the whole hierarchy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-level-zero-case">The level-zero case</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="#contributors">Contributors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="developer-tools.html">Developer Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="midi.html">MIDI</a></li>
<li class="toctree-l1"><a class="reference internal" href="specifications.html">Specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="building.html">Building the Live ISO</a></li>
<li class="toctree-l1"><a class="reference internal" href="monkey-patch.html">Monkey Patching</a></li>
<li class="toctree-l1"><a class="reference internal" href="tracing.html">Tracing with DTrace/dtruss</a></li>
<li class="toctree-l1"><a class="reference internal" href="localization.html">Localization</a></li>
<li class="toctree-l1"><a class="reference internal" href="ports.html">Working with FreeBSD Ports</a></li>
<li class="toctree-l1"><a class="reference internal" href="base.html">Working with the FreeBSD base system</a></li>
<li class="toctree-l1"><a class="reference internal" href="man.html">Writing man pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="rpi.html">Raspberry Pi</a></li>
<li class="toctree-l1"><a class="reference internal" href="linux.html">Building on Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributions.html">Note to distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">helloSystem</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Extending Filer context menus</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/helloSystem/docs/blob/main/developer/filer-context-menus.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="extending-filer-context-menus">
<h1>Extending Filer context menus<a class="headerlink" href="#extending-filer-context-menus" title="Permalink to this heading"></a></h1>
<p>It is possible to extend Filer context menu items by writing files that conform to the <strong>DES-EMA</strong> (Desktop Entry Specification - Extension for Menus and Actions). Apparently this format was never adopted as a standard, so it is documented here. The information on this page is based on <a class="reference external" href="https://gitlab.gnome.org/GNOME/filemanager-actions/-/blob/NAUTILUS_ACTIONS_3_2_4/docs/des-ema/des-ema-0.15">draft 0.15</a> from November 23, 2010.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Filer inherits its DES-EMA implementation from PCManFM, but may use a different format in the future.</p>
<p>It still needs to be verified which portions have actually been implemented in Filer, so currently this page describes functionality which may or may not be implemented in Filer. Corrections are welcome.</p>
</div>
<p>Changes take effect after a restart of Filer. To restart Filer:</p>
<ol class="arabic simple">
<li><p>Press <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">Alt</kbd>+<kbd class="kbd docutils literal notranslate">Esc</kbd></kbd> and click on the Desktop to force-quit it</p></li>
<li><p>Press <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Alt</kbd>+<kbd class="kbd docutils literal notranslate">F2</kbd></kbd> and enter <code class="docutils literal notranslate"><span class="pre">launch</span> <span class="pre">Filer</span> <span class="pre">--desktop</span></code> to start it again</p></li>
</ol>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading"></a></h2>
<div class="section" id="an-example-of-an-action">
<h3>An example of an action<a class="headerlink" href="#an-example-of-an-action" title="Permalink to this heading"></a></h3>
<p>In the following example, we define an “Open terminal here” action, which has three profiles. These profiles are thought to be able to open a suitable terminal in most situations. They are ordered, and so only the first profile whose conditions are met at runtime will be used in the Filer context menu.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[Desktop Entry]
Name=Open terminal here
Tooltip=Open a new terminal here
Icon=terminal
Profiles=on_folder; on_file; on_desktop;

[X-Action-Profile on_folder]
Name=open a terminal on the current folder or on the selected folder
MimeTypes=inode/directory;
# note that this means strictly less than 2, as the equal sign is part of the DES syntax
SelectionCount=&lt; 2
Exec=launch QTerminal --workdir %d

[X-Action-Profile on_file]
Name=open a terminal in the folder which contains selected items
MimeTypes=all/allfiles;
Exec=launch QTerminal --workdir $(echo %D | cut -d &#39; &#39; -f 1)

[X-Action-Profile on_desktop]
Name=open a terminal of the desktop
Schemes=x-nautilus-desktop;
Exec=launch QTerminal --workdir ~/Desktop
</pre></div>
</div>
<p>This may be saved, e.g. as <code class="file docutils literal notranslate"><span class="pre">~/.local/share/file-manager/actions/open-terminal.desktop</span></code> file.</p>
<p>Note that this is only an example of how an action may be defined in a <code class="docutils literal notranslate"><span class="pre">.desktop</span></code> file. It has not been deeply tested, and there is most probably more efficient ways of opening a terminal somewhere…</p>
</div>
<div class="section" id="an-example-of-a-menu">
<h3>An example of a menu<a class="headerlink" href="#an-example-of-a-menu" title="Permalink to this heading"></a></h3>
<p>Suppose we would like to place the menu elements into a submenu. To achieve this, we create a second <code class="docutils literal notranslate"><span class="pre">.desktop</span></code> file with following content:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[Desktop Entry]
Type=Menu
Name=Terminal menu
Tooltip=Terminal submenu
Icon=terminal-group
ItemsList=open-terminal;
</pre></div>
</div>
<p>This may be saved, e.g. as <code class="file docutils literal notranslate"><span class="pre">~/.local/share/file-manager/actions/menu-terminal.desktop</span></code> file.</p>
</div>
</div>
<div class="section" id="desktop-file">
<h2>Desktop file<a class="headerlink" href="#desktop-file" title="Permalink to this heading"></a></h2>
<div class="section" id="desktop-file-format">
<h3>Desktop file format<a class="headerlink" href="#desktop-file-format" title="Permalink to this heading"></a></h3>
<p>This specification relies on the common syntax defined in the <a class="reference external" href="http://standards.freedesktop.org/desktop-entry-spec/desktop-entry-spec-latest.html">Desktop Entry Specification</a>. Here is a summary of some main points:</p>
<ul class="simple">
<li><p>Files are UTF-8 encoded.</p></li>
<li><p>All keys and values are case sensitive.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">[Desktop</span> <span class="pre">Entry]</span></code> group must be the first group of the file.</p></li>
<li><p>Boolean values must be <code class="docutils literal notranslate"><span class="pre">true</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></li>
<li><p>Strings, in strings lists, are semicolon-separated; the list itself ends with a semicolon.</p></li>
</ul>
</div>
<div class="section" id="desktop-file-identifier">
<h3>Desktop file identifier<a class="headerlink" href="#desktop-file-identifier" title="Permalink to this heading"></a></h3>
<p>In the rest of this specification, when a desktop file needs to be identified, we are using the basename of the file, without the extension, calling this a <em>desktop_file_id</em>.</p>
</div>
<div class="section" id="desktop-files-search-path">
<h3>Desktop files search path<a class="headerlink" href="#desktop-files-search-path" title="Permalink to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">.desktop</span></code> files are searched for in <code class="file docutils literal notranslate"><span class="pre">XDG_DATA_DIRS/file-manager/actions</span></code> directories. All used _desktop_file_id_s should be unique.</p>
</div>
</div>
<div class="section" id="managed-objects">
<h2>Managed objects<a class="headerlink" href="#managed-objects" title="Permalink to this heading"></a></h2>
<div class="section" id="actions-and-profiles">
<h3>Actions and profiles<a class="headerlink" href="#actions-and-profiles" title="Permalink to this heading"></a></h3>
<p>This specification essentially defines how actions are to be described in <code class="docutils literal notranslate"><span class="pre">.desktop</span></code> files in order to be displayed in the Filer context menu, and available as selectable items to be executed by the user.</p>
<p>An action might be defined as a group of several elements:</p>
<ul class="simple">
<li><p>the displayable part: label, tooltip, icon</p></li>
<li><p>conditions which have to be met in order the item be actually displayed in the context menu; these conditions are checked against the current Filer selection; these might be mimetypes, scheme, etc.</p></li>
<li><p>the command to be executed, and its parameters.</p></li>
</ul>
<p>As a user might want have the very same action execute a different command depending of the current environment at runtime, we define that an action is built on one to several profiles, where each profile is defined by:</p>
<ul class="simple">
<li><p>conditions which have to be met in order the item be actually displayed in the context menu; these conditions are checked against the current Filer selection; these might be mimetypes, scheme, etc.</p></li>
<li><p>the command to be executed, and its parameters.</p></li>
</ul>
</div>
<div class="section" id="menus">
<h3>Menus<a class="headerlink" href="#menus" title="Permalink to this heading"></a></h3>
<p>This specification also defines how these actions may be gathered and ordered in menus, and submenus, and so on.</p>
<p>A menu is defined by:</p>
<ul class="simple">
<li><p>its displayable part: label, tooltip, icon</p></li>
<li><p>conditions which are to be met in order the menu, and recursively all of its subitems, be actually displayed in the Filer context menu</p></li>
<li><p>the ordered list of the items in the menu.</p></li>
</ul>
</div>
<div class="section" id="conditions">
<h3>Conditions<a class="headerlink" href="#conditions" title="Permalink to this heading"></a></h3>
<p>As we are dealing with three level of objects (menus, actions, profiles), it appears that whether a condition must be defined at one of these levels is rather an arbitrary decision.</p>
<p>We so say that conditions may appear in any of these levels:</p>
<ul class="simple">
<li><p>When a condition appears in a menu definition, the result of its evaluation recursively applies to all included items. If the condition is not met, then neither the menu nor any of its subitems will be displayed.</p></li>
<li><p>When a condition appears in an action definition, the result of its evaluation applies to all its profiles. If the condition is not met, then the action will not be candidate; the profiles will even not be considered.</p></li>
</ul>
</div>
</div>
<div class="section" id="action-definition">
<h2>Action definition<a class="headerlink" href="#action-definition" title="Permalink to this heading"></a></h2>
<p>An action must be entirely defined in one <code class="docutils literal notranslate"><span class="pre">.desktop</span></code> file. The action is identified by the <em>desktop_file_id</em> in which it is defined.</p>
<p>Only valid actions are displayed in the Filer context menu.</p>
<p>To be valid, an action must have a non-empty name, and at least one profile must be found valid at runtime.</p>
<p>As stated</p>
<p>An action is primarily defined in the <code class="docutils literal notranslate"><span class="pre">[Desktop</span> <span class="pre">Entry]</span></code> group, which has following keys:</p>
<table border="1">
<tbody>
<tr valign="top">
<td>**Key**</td>
<td>**Description**</td>
<td nowrap="nowrap">**Value type**</td>
<td>**Req ?**</td>
</tr>
<tr valign="top">
<td>`Type`</td>
<td>This define this `.desktop` file as an Action definition.  
Defaults to `Action`.</td>
<td>string</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`Name`</td>
<td>The label of the action, as it should appear in the context menu.  
</td>
<td>localestring</td>
<td>YES</td>
</tr>
<tr valign="top">
<td>`Tooltip`</td>
<td>The tooltip associated with the item in the context menu.  
Defaults to empty.</td>
<td>localestring</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`Icon`</td>
<td>The name of a themed icon, or the path to an icon.  
Defaults to empty.</td>
<td>localestring</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`Description`</td>
<td>A free description of the action, which may be used in the management UI, in a Web page, and so on.  
Defaults to empty.</td>
<td>localestring</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`SuggestedShortcut`</td>
<td>A shortcut suggested for the action.  
Please note that this might be only a suggestion as the shortcut may be already reserved for another use. Implementation should not override an already existing shortcut to define this one.  
The format may look like `<Control>a` or `<Shift><Alt>F1`.  
Defaults to empty.</td>
<td>string</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`Enabled`</td>
<td>Whether the item is candidate to be displayed in the context menu.  
A user might define many actions or menus, and choose to only enable some of them from time to time.  
Defaults to `true`.</td>
<td>boolean</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`Hidden`</td>
<td>From [DES](http://standards.freedesktop.org/desktop-entry-spec/desktop-entry-spec-latest.html): `Hidden` should have been called `Deleted`. It means the user deleted (at his level) something that was present (at an upper level, e.g. in the system dirs). It's strictly equivalent to the `.desktop` file not existing at all, as far as that user is concerned. This can also be used to "uninstall" existing files (e.g. due to a renaming) - by letting make install install a file with `Hidden=true` in it.  
Defaults to `false`.</td>
<td>boolean</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`TargetContext`</td>
<td>Whether the item targets the Filer context menu.  
This means that the action will be candidate if defined conditions met the current selection.  
Defaults to `true`.</td>
<td>boolean</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`TargetLocation`</td>
<td>Whether the item targets a location menu, if Filer supports this.  
This means that the action will be candidate if defined conditions met the current location.  
Defaults to `false`.</td>
<td>boolean</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`TargetToolbar`</td>
<td>Whether the item targets the toolbar, if Filer supports this.  
Note that, in order to keep a nice and stable UI, the Filer may reserve toolbar actions to those only targeting the current folder.  
Defaults to `false`.</td>
<td>boolean</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`ToolbarLabel`</td>
<td>The label to be displayed in the toolbar, if it is not the same that those displayed in context menu.  
Defaults to `Name` value.</td>
<td>localestring</td>
<td>no</td>
</tr>
<tr valign="top">
<td nowrap="nowrap">`Profiles`</td>
<td>
<p>The ordered list of the profiles attached to this action.<br />
Each element of this strings list may be:</p>
<ul class="simple">
<li><p>a <code class="docutils literal notranslate"><span class="pre">_profile_id_</span></code>, <em>i.e.</em> the id of a profile, as an ASCII string</p></li>
<li><p>a command to be executed, if the string is enclosed between square brackets (<code class="docutils literal notranslate"><span class="pre">[</span></code>…<code class="docutils literal notranslate"><span class="pre">]</span></code>).</p></li>
</ul>
<p>So, <code class="docutils literal notranslate"><span class="pre">Profiles</span></code> key has a dynamic value: if an element of the string list is enclosed between square brackets (<code class="docutils literal notranslate"><span class="pre">[</span></code>…<code class="docutils literal notranslate"><span class="pre">]</span></code>), it is considered as a command, optionally with</p>
<p>After reading, and maybe evaluation of dynamic elements, profiles identified by the <code class="docutils literal notranslate"><span class="pre">Profiles</span></code> value, but not found in this <code class="docutils literal notranslate"><span class="pre">.desktop</span></code> file, are just ignored.</p>
<p>It is up to the implementation to decide whether profiles found in this <code class="docutils literal notranslate"><span class="pre">.desktop</span></code> file, but not identified in this list, should or not be attached to the action.<br />
It could be for example an acceptable fallback to append these “orphan” profiles at the end of the list of profiles.</p>
<p>Another choice might also be:</p>
<ul class="simple">
<li><p>at runtime, only attach to the action profiles which are listed in this <code class="docutils literal notranslate"><span class="pre">Profiles</span></code> key</p></li>
<li><p>while a management UI may load all profiles found in the <code class="docutils literal notranslate"><span class="pre">.desktop</span></code> file.</p></li>
</ul>
</td>
<td>strings list</td>
<td>YES</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="profile-definition">
<h2>Profile definition<a class="headerlink" href="#profile-definition" title="Permalink to this heading"></a></h2>
<p>Profile is identified by its <em>profile_id</em>, as an ASCII string.</p>
<p>Each profile defined in the <code class="docutils literal notranslate"><span class="pre">Profiles</span></code> key, whether statically by its <em>profile_id</em> identifier, or as the result of an evaluated command, must be defined in a <code class="docutils literal notranslate"><span class="pre">[X-Action-Profile</span> <span class="pre">_profile_id_]</span></code> group.</p>
<p>When several profiles are defined for an action, only the first valid profile whose conditions are met at runtime is selected to be made available in the context menu.</p>
<p>Defining several profiles let so the user have an ordered OR-ed set of conditions, i.e. have one action be available if one set of conditions is met, OR this same action, though most probably with a slightly different command, be available if another set of conditions is met, and so on.</p>
<p>In order to be valid, a profile must at least have an executable command.</p>
<table border="1">
<tbody>
<tr valign="top">
<td>**Key**</td>
<td>**Description**</td>
<td nowrap="nowrap">**Value type**</td>
<td>**Req ?**</td>
</tr>
<tr valign="top">
<td>`Name`</td>
<td>The name of the profile; this name is not displayed in the context menu, and should just be thought as a convenience for the management UI. It may also be seen as a good place for a description of what the profile exactly does.  
Defaults to empty.</td>
<td>localestring</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`Exec`</td>
<td>From [DES](http://standards.freedesktop.org/desktop-entry-spec/desktop-entry-spec-latest.html): command to execute, possibly with arguments  
</td>
<td>string</td>
<td>YES</td>
</tr>
<tr valign="top">
<td>`Path`</td>
<td>The working directory the program should be started in.  
Defaults to base directory of the current selection, which happens to be the value of `%d` parameter.</td>
<td>string</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`ExecutionMode`</td>
<td>Execution mode of the program.  
This may be chosen between following values:
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Normal</span></code>: Starts as a standard graphical user interface</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Terminal</span></code>: Starts the preferred terminal of the graphical environment, and runs the command in it</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Embedded</span></code>: Makes use of a special feature of the file manager which allows a terminal to be ran inside of it; an acceptable fallback is <code class="docutils literal notranslate"><span class="pre">Terminal</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DisplayOutput</span></code>: The ran terminal may be closed at end of the command, but standard streams (stdout, stderr) should be collected and displayed; an acceptable fallback is <code class="docutils literal notranslate"><span class="pre">Terminal</span></code></p></li>
</ul>
<p>Defaults to <code class="docutils literal notranslate"><span class="pre">Normal</span></code>.</td></p>
<td>string</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`StartupNotify`</td>
<td>From [DES](http://standards.freedesktop.org/desktop-entry-spec/desktop-entry-spec-latest.html): if `true`, it is KNOWN that the application will send a "remove" message when started with the DESKTOP_STARTUP_ID environment variable set. If `false`, it is KNOWN that the application does not work with startup notification at all (does not shown any window, breaks even when using StartupWMClass, etc.). If absent, a reasonable handling is up to implementations (assuming false, using StartupWMClass, etc.). (See the [Startup Notification Protocol Specification](http://www.freedesktop.org/Standards/startup-notification-spec) for more details).  
Only relevant when `ExecutionMode=Normal`.  
Defaults to `false`.</td>
<td>boolean</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`StartupWMClass`</td>
<td>From [DES](http://standards.freedesktop.org/desktop-entry-spec/desktop-entry-spec-latest.html): if specified, it is known that the application will map at least one window with the given string as its WM class or WM name hint (see the [Startup Notification Protocol Specification](http://www.freedesktop.org/Standards/startup-notification-spec) for more details).  
Only relevant when `ExecutionMode=Normal`.  
Defaults to empty.</td>
<td>string</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`ExecuteAs`</td>
<td>The user the command must be ran as. The user may be identified by its numeric UID or by its login.  
The implementation should ignore a profile defining a non-existing UID or login as a value for the `ExecuteAs` key.  
The implementation might require the presence of a well-configured subsystem (e.g. sudo).  
Defaults to empty: the command will be executed as the current user.</td>
<td>string</td>
<td>no</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="menu-definition">
<h2>Menu definition<a class="headerlink" href="#menu-definition" title="Permalink to this heading"></a></h2>
<p>Just as an action, a menu has label, tooltip, icon.</p>
<p>But, where an action is intended to eventually execute a command, a menu is just a way of gathering some subitems, actions or menus, in an ordered list.</p>
<p>In order to be valid, a menu must have a non-empty name, and include at least one valid subitem.</p>
<p>It is the responsibility of the implementation to ensure that the displayed menus are relevant, <em>i.e.</em> not empty, with no separator at the begin or the end of the menu, with no double separator, etc.</p>
<p>As stated</p>
<p>The menu is so defined as a particular case of a <code class="docutils literal notranslate"><span class="pre">.desktop</span></code> file, identified by its <code class="docutils literal notranslate"><span class="pre">desktop_file_id</span></code>, whose the <code class="docutils literal notranslate"><span class="pre">[Desktop</span> <span class="pre">Entry]</span></code> section has following keys:</p>
<table border="1">
<tbody>
<tr valign="top">
<td nowrap="nowrap">**Key**</td>
<td>**Description**</td>
<td nowrap="nowrap">**Value type**</td>
<td>**Req ?**</td>
</tr>
<tr valign="top">
<td>`Type`</td>
<td>This define this `.desktop` file as a Menu definition.  
Must be equal to `Menu`.</td>
<td>string</td>
<td>YES</td>
</tr>
<tr valign="top">
<td>`Name`</td>
<td>The label of the menu, as it should appear in the context menu.  
</td>
<td>localestring</td>
<td>YES</td>
</tr>
<tr valign="top">
<td>`Tooltip`</td>
<td>The tooltip associated with the submenu in the context menu.  
Defaults to empty.</td>
<td>localestring</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`Icon`</td>
<td>The name of a themed icon, or the path to an icon, to be associated to the submenu.  
Defaults to empty.</td>
<td>localestring</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`Description`</td>
<td>A free description of the menu, which may be used in the management UI, in a Web page, and so on.  
Defaults to empty.</td>
<td>localestring</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`SuggestedShortcut`</td>
<td>A shortcut suggested for the menu.  
Please note that this might be only a suggestion as the shortcut may be already reserved for another use. Implementation should not override an already existing shortcut to define this one.  
The format may look like `<Control>a" or `<Shift><Alt>F1".  
Defaults to empty.</td>
<td>string</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`Enabled`</td>
<td>Whether the item is candidate to be displayed in the context menu.  
A user might define many actions or menus, and choose to only enable some of them from time to time.  
Defaults to `true`.</td>
<td>boolean</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`Hidden`</td>
<td>From [DES](http://standards.freedesktop.org/desktop-entry-spec/desktop-entry-spec-latest.html): `Hidden` should have been called `Deleted`. It means the user deleted (at his level) something that was present (at an upper level, e.g. in the system dirs). It's strictly equivalent to the `.desktop` file not existing at all, as far as that user is concerned. This can also be used to "uninstall" existing files (e.g. due to a renaming) - by letting make install install a file with `Hidden=true` in it.  
Defaults to `false`.</td>
<td>boolean</td>
<td>no</td>
</tr>
<tr valign="top">
<td nowrap="nowrap" id="itemslist">`ItemsList`</td>
<td>
<p>The ordered list of the subitems (actions or menus) attached to this menu.<br />
Each element of this strings list may be:</p>
<ul class="simple">
<li><p>the id of an action or a menu,</p></li>
<li><p>a command to be executed, if the string is enclosed between square brackets (<code class="docutils literal notranslate"><span class="pre">[</span></code>…<code class="docutils literal notranslate"><span class="pre">]</span></code>).</p></li>
</ul>
<p>So, <code class="docutils literal notranslate"><span class="pre">ItemsList</span></code> key has a dynamic value: if an element of the string list is enclosed between square brackets (<code class="docutils literal notranslate"><span class="pre">[</span></code>…<code class="docutils literal notranslate"><span class="pre">]</span></code>), it is considered as a command, optionally with</p>
<p>The keyword <code class="docutils literal notranslate"><span class="pre">SEPARATOR</span></code> is a special case of <em>desktop_file_id</em>. It may be used to define a separator in the menu.</p>
<p>Actions or menus identified here as a subitem of a menu should not be redisplayed elsewhere.</p>
<p>Actions or menus not identified here, or not identified as subitems of a menu or of a submenu, should not be ignored by the implementation; instead of that, the implementation should display these “orphan” items, most probably at the level zero of the hierarchy (though in a unspecified order).</p>
</td>
<td>strings list</td>
<td>YES</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id1">
<h2>Conditions<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h2>
<p>As a remainder of that has been said above, each one of the following conditions may appear in a menu, an action or a profile.</p>
<p>Conditions are AND-ed, that is all specified conditions which appear in a menu, an action or a profile must be met in order the item be considered as a candidate.</p>
<p>When a condition is defined as a string list, elements of the list are considered as OR-ed (but for When an element of the string list is negated, it must be considered as an AND condition.</p>
<p>Example:</p>
<blockquote>
<div><p>The line “<code class="docutils literal notranslate"><span class="pre">MimeTypes</span> <span class="pre">=</span> <span class="pre">image/*;</span> <span class="pre">video/*;</span></code>” must be read as “condition is met if each file in the current selection has a mimetype of <code class="docutils literal notranslate"><span class="pre">image/*</span></code> or of <code class="docutils literal notranslate"><span class="pre">video/*</span></code>”</p>
<p>And the line “<code class="docutils literal notranslate"><span class="pre">MimeTypes</span> <span class="pre">=</span> <span class="pre">image/*;</span> <span class="pre">video/*;</span> <span class="pre">!image/bmp</span></code>” must be read as “condition is met if each file in the current selection has a mimetype of <code class="docutils literal notranslate"><span class="pre">image/*</span></code> or of <code class="docutils literal notranslate"><span class="pre">video/*</span></code>, but must not have the <code class="docutils literal notranslate"><span class="pre">image/bmp</span></code> mimetype”.</p>
</div></blockquote>
<table border="1">
<tbody>
<tr valign="top">
<td>**Key**</td>
<td>**Description**</td>
<td nowrap="nowrap">**Value type**</td>
<td>**Req ?**</td>
</tr>
<tr valign="top">
<td>`OnlyShowIn`,  
`NotShowIn`</td>
<td>From [DES](http://standards.freedesktop.org/desktop-entry-spec/desktop-entry-spec-latest.html): a list of strings identifying the environments that should display/not display a given desktop entry. Only one of these keys, either `OnlyShowIn` or `NotShowIn`, may appear in a group (for possible values see the [Desktop Menu Specification](http://www.freedesktop.org/Standards/menu-spec)).  
Defaults to show anywhere.</td>
<td nowrap="nowrap">strings list</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`TryExec`</td>
<td>From [DES](http://standards.freedesktop.org/desktop-entry-spec/desktop-entry-spec-latest.html): path to an executable file on disk used to determine if some program is actually installed. If the path is not an absolute path, the file is looked up in the $PATH environment variable. If the file is not found or is not executable, this condition evals to `false`.  
Defaults to successful.</td>
<td>string</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`ShowIfRegistered`</td>
<td>The well-known name of a DBus service.  
The item will be candidate if the named service is registered on session DBus at runtime.  
Defaults to successful.  
<table border="0">
<tbody>
<tr>
<td valign="top">_Comment:_</td>
<td valign="top">_This is the equivalent of KDE `X-KDE-ShowIfRunning` key._</td>
</tr>
</tbody>
</table>
</td>
<td>string</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`ShowIfTrue`</td>
<td>A command which, when executed, should output a string on stdout.  
The item will be candidate if the outputted string is equal to `true`.  
Example: `[ -r %d/.svn/entries ] && echo \"true\`  
Defaults to successful.  
<table border="0">
<tbody>
<tr>
<td valign="top">_Comment:_</td>
<td valign="top">_This is the equivalent of KDE `X-KDE-ShowIfDBusCall` key, extended to any command able to output a string._</td>
</tr>
</tbody>
</table>
</td>
<td>string</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`ShowIfRunning`</td>
<td>The name of a process.  
The item will be candidate if the process name is found in memory at runtime.  
Defaults to successful.</td>
<td>string</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`MimeTypes`</td>
<td>From [DES](http://standards.freedesktop.org/desktop-entry-spec/desktop-entry-spec-latest.html): the MIME type(s) supported by this application.  
Each mimetype may be fully specified (e.g. `audio/mpeg;`), or as a group (e.g. `image/*;`).  
Mimetypes may be negated (e.g. `audio/*; !audio/mpeg;`).  
Some of well-known mimetypes include:  
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">all/all</span></code>: matches all items</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">all/allfiles</span></code>: matches only files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inode/directory</span></code>: matches only directories</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">*</span></code> character is accepted as a wildcard in only two cases:</p>
<ul class="simple">
<li><p>when used alone as in <code class="docutils literal notranslate"><span class="pre">*;</span></code>, <em>i.e.</em> when used as a group wildcard without subgroup,</p></li>
<li><p>when used as the subgroup wildcard, after the <code class="docutils literal notranslate"><span class="pre">/</span></code> character, as in <code class="docutils literal notranslate"><span class="pre">image/*</span></code>.</p></li>
</ul>
<p>Defaults to <code class="docutils literal notranslate"><span class="pre">*;</span></code>, which happens to be exactly equivalent to <code class="docutils literal notranslate"><span class="pre">all/all</span></code> or to <code class="docutils literal notranslate"><span class="pre">all/*</span></code>.</p>
<table border="0">
<tbody>
<tr>
<td valign="top">_Comment:_</td>
<td></td>
<td>_This is the equivalent of `ServiceTypes`, `X-KDE-ServiceTypes`, `ExcludeServiceTypes` KDE and `MimeType` freedesktop keys._</td>
</tr>
</tbody>
</table>
</td>
<td>strings list</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`Basenames`</td>
<td>List of basenames the selection should match in order this profile be selected.  
`*` character is accepted as a wildcard.  
Basenames may be negated (e.g. `*; !*.h;`).  
Defaults to `*;`.</td>
<td>strings list</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`Matchcase`</td>
<td>Whether the above `Basenames` is case sensitive.  
Defaults to `true`.</td>
<td>boolean</td>
<td>no</td>
</tr>
<tr valign="top">
<td id="selection-count">`SelectionCount`</td>
<td>Whether this profile may be selected depending of the count of the selection.  
This is a string of the form `{'<'|'='|'>'} number`.  
Examples of valid strings are: `=0`, `> 1`, `< 10`.  
Defaults to `>0`.</td>
<td>string</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`Schemes`</td>
<td>The list of schemes the selection must satisfy in order the item be selected.  
Examples of well-known schemes are:  
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">file</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sftp</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">smb</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">http</span></code></p></li>
</ul>
<p>Schemes may be negated, e.g. <code class="docutils literal notranslate"><span class="pre">!http;</span></code>.<br />
Defaults to <code class="docutils literal notranslate"><span class="pre">*;</span></code>.</p>
<table border="0">
<tbody>
<tr>
<td valign="top">_Comment:_</td>
<td valign="top">_This is the equivalent of `X-KDE-Protocol` and `X-KDE-Protocols` KDE keys._</td>
</tr>
</tbody>
</table>
</td>
<td>strings list</td>
<td>no</td>
</tr>
<tr valign="top">
<td>`Folders`</td>
<td>A list of paths the current base directory must be in in order the item be selected.  
A folder path may be negated (e.g. `/data; !/data/resources/secret;`).  
`*` character is accepted as a wildcard, replacing any level(s) of subdirectory (e.g. `/music; /video; !*/secret;`).  
Also note that a terminating `/*` is always implied by the definition of this key.  
Last, note that different implementations today widely consider that, for a directory point of view, having no selection is roughly the same that selecting the currently opened folder. If this makes a difference for your action, then</td>
<td>strings list</td>
<td>no</td>
</tr>
<tr valign="top">
<td id="capabilities">`Capabilities`</td>
<td>A list of capabilities each item of the selection must satisfy in order the item be candidate.  
Capabilities may be negated.  
Please note that each element of the specified list must be considered as ANDed, i.e. if we have `Capabilities=Readable;Writable;!Local`, then each element of the selection must be both readable AND writable AND not local.  
Capabilities have to be chosen between following predefined ones:
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Owner</span></code>: current user is the owner of the selected items</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Readable</span></code>: selected items are readable by user (probably more useful when negated)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Writable</span></code>: selected items are writable by user</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Executable</span></code>: selected items are executable by user</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Local</span></code>: selected items are local</p></li>
</ul>
<p>Defaults to an empty list (do not care of capabilities).</p>
<table border="0">
<tbody>
<tr>
<td valign="top">_Comment:_</td>
<td valign="top">_This is the equivalent of `X-KDE-Require` KDE key._</td>
</tr>
</tbody>
</table>
</td>
<td>strings list</td>
<td>no</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Permalink to this heading"></a></h2>
<div class="section" id="parameters-expansion">
<h3>Parameters expansion<a class="headerlink" href="#parameters-expansion" title="Permalink to this heading"></a></h3>
<p>Whenever parameters are said to be accepted, they will be replaced at run-time.</p>
<p>It should be noted by the implementation that items, actions or menus, which were considered valid at load time, may become invalid after parameters expansion, due, for example, to a label becoming empty.</p>
<p>Also, this specification doesn’t make any assumption about whether a parameter is relevant in a given situation, or secure, or may be used several times, or so. It instead considers that this sort of check is up to the action creator.</p>
<p>The implementation should take care of correctly shell-escape the substituted values, so that it should not be needed for the action creator to use any sort of quotes to handle spaces in filenames.</p>
</div>
<div class="section" id="multiple-execution">
<h3>Multiple execution<a class="headerlink" href="#multiple-execution" title="Permalink to this heading"></a></h3>
<p>The action creator may want its command be executed once, giving it the list of selected items as argument.</p>
<p>Or the action creator may want its command be repeated for each selected item, giving to each execution a different item as argument.</p>
<p>Actually, the command defined in the <code class="docutils literal notranslate"><span class="pre">Exec</span></code> key will be executed once, or repeated for each selected item, depending of the form of arguments.</p>
<p>Though some parameters are not sensible to the count of the selection (e.g. <code class="docutils literal notranslate"><span class="pre">%c</span></code>, the selection count itself), most have two declensions:</p>
<ul class="simple">
<li><p>a “singular” one, e.g. <code class="docutils literal notranslate"><span class="pre">%b</span></code>, the basename of the selected item</p></li>
<li><p>a “plural” one, e.g. <code class="docutils literal notranslate"><span class="pre">%B</span></code>, a space-separated list of the basenames of selected items</p></li>
</ul>
<p>When the selection is empty or contains only one element, and from this topic point of view, these two forms are exactly equivalent.</p>
<p>When the selection contains more than one item:</p>
<ul class="simple">
<li><p>if the first relevant parameter found in the <code class="docutils literal notranslate"><span class="pre">Exec</span></code> key is of a singular form, then the implementation should consider that the command is only able to deal with one item at a time, and thus that it has to be ran one time for each selected item;</p></li>
<li><p>contrarily, if the first relevant parameter found is of the plural form, then the implementation should consider that the command is able to deal with a list of items, and thus the command should be executed only once;</p></li>
<li><p>if all found parameters are “irrelevant”, then the default is to consider that the command should be executed only once.</p></li>
</ul>
<p>Example:</p>
<blockquote>
<div><p>Say the current folder is /data, and the current selection contains the three files <code class="docutils literal notranslate"><span class="pre">pierre</span></code>, <code class="docutils literal notranslate"><span class="pre">paul</span></code> and <code class="docutils literal notranslate"><span class="pre">jacques</span></code>.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">Exec</span></code> key is <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">%b</span></code>, then the following commands will be run:<br />
<code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">pierre</span></code><br />
<code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">paul</span></code><br />
<code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">jacques</span></code></p>
<p>If the <code class="docutils literal notranslate"><span class="pre">Exec</span></code> key is <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">%B</span></code>, then the following command will be run:<br />
<code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">pierre</span> <span class="pre">paul</span> <span class="pre">jacques</span></code></p>
<p>If the <code class="docutils literal notranslate"><span class="pre">Exec</span></code> key is <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">%b</span> <span class="pre">%B</span></code>, then the following commands will be run:<br />
<code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">pierre</span> <span class="pre">pierre</span> <span class="pre">paul</span> <span class="pre">jacques</span></code><br />
<code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">paul</span> <span class="pre">pierre</span> <span class="pre">paul</span> <span class="pre">jacques</span></code><br />
<code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">jacques</span> <span class="pre">pierre</span> <span class="pre">paul</span> <span class="pre">jacques</span></code></p>
<p>If the <code class="docutils literal notranslate"><span class="pre">Exec</span></code> key is <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">%B</span> <span class="pre">%b</span></code>, then the following commands will be run:<br />
<code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">pierre</span> <span class="pre">paul</span> <span class="pre">jacques</span> <span class="pre">pierre</span></code><br />
The basename used is the one of the first item of the selected items list as provided by the Filer. There is only a small chance that it would be those of the first visually selected item, and there is contrarily great chances that it would not be predictable at all.</p>
<p>Even if the chosen parameter is the same for all selected items, the behavior is identical.<br />
If the <code class="docutils literal notranslate"><span class="pre">Exec</span></code> key is <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">%d</span> <span class="pre">%B</span></code>, then the following commands will be run:<br />
<code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">/data</span> <span class="pre">pierre</span> <span class="pre">paul</span> <span class="pre">jacques</span></code><br />
<code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">/data</span> <span class="pre">pierre</span> <span class="pre">paul</span> <span class="pre">jacques</span></code><br />
<code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">/data</span> <span class="pre">pierre</span> <span class="pre">paul</span> <span class="pre">jacques</span></code><br />
which obviously doesn’t make many sense.</p>
<p>As the last three examples show up, action creator should avoid to mix singular and plural forms, unless they know what they are doing, whether it doesn’t make sense or this may lead to unwaited results.</p>
<p>Nonetheless, mixing singular and plural forms, though we warn against, is not an error. As a counter example, there may be some situations where a command-line of the form <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">%B</span> <span class="pre">%d</span></code> would be useful. In that case, the following command would be run:<br />
<code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">pierre</span> <span class="pre">paul</span> <span class="pre">jacques</span> <span class="pre">/data</span></code><br />
It is left as an exercise for the reader to find a use case.</p>
</div></blockquote>
<p>The word “first” in the following table makes so reference to the case where the singular form parameter is used in a plural form command. We recall one more time that which is the “first” element is not specified, and, most probably, rather unpredictable.</p>
<table border="1">
<tbody>
<tr valign="top">
<td align="center">**Parameter**</td>
<td>**Description**</td>
<td colspan="3" align="center">**Said form**</td>
</tr>
<tr valign="top">
<td align="center">%b</td>
<td>(first) basename</td>
<td>singular</td>
<td></td>
<td></td>
</tr>
<tr valign="top">
<td align="center">%B</td>
<td>space-separated list of basenames</td>
<td></td>
<td></td>
<td>plural</td>
</tr>
<tr valign="top">
<td align="center">%c</td>
<td>count of selected items</td>
<td></td>
<td>irrelevant</td>
<td></td>
</tr>
<tr valign="top">
<td align="center">%d</td>
<td>(first) base directory</td>
<td>singular</td>
<td></td>
<td></td>
</tr>
<tr valign="top">
<td align="center">%D</td>
<td>space-separated list of base directory of each selected items</td>
<td></td>
<td></td>
<td>plural</td>
</tr>
<tr valign="top">
<td align="center">%f</td>
<td>(first) file name</td>
<td>singular</td>
<td></td>
<td></td>
</tr>
<tr valign="top">
<td align="center">%F</td>
<td>space-separated list of selected file names</td>
<td></td>
<td></td>
<td>plural</td>
</tr>
<tr valign="top">
<td align="center">%h</td>
<td>hostname of the (first) URI</td>
<td></td>
<td>irrelevant</td>
<td></td>
</tr>
<tr valign="top">
<td align="center">%m</td>
<td>mimetype of the (first) selected item</td>
<td>singular</td>
<td></td>
<td></td>
</tr>
<tr valign="top">
<td align="center">%M</td>
<td>space-separated list of the mimetypes of the selected items</td>
<td></td>
<td></td>
<td>plural</td>
</tr>
<tr valign="top">
<td align="center">%n</td>
<td>username of the (first) URI</td>
<td></td>
<td>irrelevant</td>
<td></td>
</tr>
<tr valign="top">
<td align="center">%o</td>
<td>no-op operator which forces a singular form of execution when specified as first parameter,  
ignored else</td>
<td>singular</td>
<td></td>
<td></td>
</tr>
<tr valign="top">
<td align="center">%O</td>
<td>no-op operator which forces a plural form of execution when specified as first parameter,  
ignored else</td>
<td></td>
<td></td>
<td>plural</td>
</tr>
<tr valign="top">
<td align="center">%p</td>
<td>port number of the (first) URI</td>
<td></td>
<td>irrelevant</td>
<td></td>
</tr>
<tr valign="top">
<td align="center">%s</td>
<td>scheme of the (first) URI</td>
<td></td>
<td>irrelevant</td>
<td></td>
</tr>
<tr valign="top">
<td align="center">%u</td>
<td>(first) URI</td>
<td>singular</td>
<td></td>
<td></td>
</tr>
<tr valign="top">
<td align="center">%U</td>
<td>space-separated list of selected URIs</td>
<td></td>
<td></td>
<td>plural</td>
</tr>
<tr valign="top">
<td align="center">%w</td>
<td>(first) basename without the extension</td>
<td>singular</td>
<td></td>
<td></td>
</tr>
<tr valign="top">
<td align="center">%W</td>
<td>space-separated list of basenames without their extension</td>
<td></td>
<td></td>
<td>plural</td>
</tr>
<tr valign="top">
<td align="center">%x</td>
<td>(first) extension</td>
<td>singular</td>
<td></td>
<td></td>
</tr>
<tr valign="top">
<td align="center">%X</td>
<td>space-separated list of extensions</td>
<td></td>
<td></td>
<td>plural</td>
</tr>
<tr valign="top">
<td align="center">%%</td>
<td>the "%" character</td>
<td></td>
<td>irrelevant</td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="building-the-whole-hierarchy">
<h2>Building the whole hierarchy<a class="headerlink" href="#building-the-whole-hierarchy" title="Permalink to this heading"></a></h2>
<p>The processus described here is only a sort of meta-algorithm, whose only goal is to better specify how the menus and actions should be laid out in the final hierarchy.</p>
<p>The implementer might take advantage of preparing once the whole hierarchy of the menus and actions:</p>
<ul class="simple">
<li><p>to minimize the time spent in the parsing of all files;</p></li>
<li><p>to identify and eliminate duplicate _desktop_file_id_s,</p></li>
<li><p>to eliminate invalid menus and actions.</p></li>
</ul>
<ol class="arabic simple">
<li><p>as described in desktop_file_ids and invalid <code class="docutils literal notranslate"><span class="pre">.desktop</span></code> files; implementation so obtains a flat list of menus or actions;</p></li>
<li><p>recursively build the hierarchy; this merely consists in the build of the hierarchy as a tree of menus and actions, where each <em>desktop_file_id</em> addressed as the subitem of a menu consumes this same id from the flat list</p>
<ul class="simple">
<li><p>if the level-zero order (which is not specified here, but see desktop_file_id addressed in the level zero consumes this same id from the flat list;</p></li>
<li><p>else, if might be reasonable to start with an empty tree;</p></li>
</ul>
</li>
<li><p>at the end, implementation stays with:</p>
<ul class="simple">
<li><p>the output tree with some menus at the root;</p></li>
<li><p>some actions, left in the input flat list because they were not addressed by any menu; these left actions should be added to the level zero of the hierarchy (though in a unspecified order)</p></li>
<li><p>some menus, left in the input flat list because their subitems were not found; as these menus happen to be empty, they must be considered as invalid.</p></li>
</ul>
</li>
</ol>
<p>After this built phase, the resultant tree only contains valid (before runtime parameters expansion) menus and actions.</p>
<p>So, menus or actions may appear at the level zero of the whole hierarchy for only two reasons:</p>
<ol class="arabic simple">
<li><p>because they are explicitly addressed by the level-zero configuration, if the implementation defines it; this may concern menus and actions;</p></li>
<li><p>because these items were not addressed by any menu (but this may only concern actions).</p></li>
</ol>
</div>
<div class="section" id="the-level-zero-case">
<h2>The level-zero case<a class="headerlink" href="#the-level-zero-case" title="Permalink to this heading"></a></h2>
<p>Though not strictly an action or a menu definition, the level-zero issue might be easily solved by this specification. The implementation is free to implement it or not.</p>
<p>Ordering the elements which have to be displayed at the level-zero of the Filer context menu is just a particular case of a menu definition.</p>
<p>An implementation might define a <code class="docutils literal notranslate"><span class="pre">level-zero.directory</span></code> file, which would contain the ordered list of level zero items identified by their <code class="docutils literal notranslate"><span class="pre">desktop_file_id</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">[Desktop</span> <span class="pre">Entry]</span></code> section of this <code class="docutils literal notranslate"><span class="pre">level-zero.directory</span></code> file would so have only one of the following keys:</p>
<table border="1">
<tbody>
<tr valign="top">
<td nowrap="nowrap">**Key**</td>
<td>**Description**</td>
<td nowrap="nowrap">**Value type**</td>
<td>**Req ?**</td>
</tr>
<tr valign="top">
<td>`ItemsList`</td>
<td>Same signification as</td>
<td>strings list</td>
<td>no</td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal notranslate"><span class="pre">level-zero.directory</span></code> file may be searched for in <code class="docutils literal notranslate"><span class="pre">XDG_DATA_DIRS/file-manager/actions</span></code>. The first one found would be used.</p>
<p>Not finding a <code class="docutils literal notranslate"><span class="pre">level-zero.directory</span></code> file should not prevent actions or menus to be displayed. Instead, they just would be displayed in an unspecified, implementation-dependent, order.</p>
<p>The name <code class="docutils literal notranslate"><span class="pre">level-zero.directory</span></code> is chosen to not risk any collision with regular <code class="docutils literal notranslate"><span class="pre">.desktop</span></code> files.</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="http://standards.freedesktop.org/desktop-entry-spec/desktop-entry-spec-latest.html">Desktop Entry Specification</a></p></li>
<li><p><a class="reference external" href="http://standards.freedesktop.org/menu-spec/menu-spec-latest.html">Desktop Menu Specification</a></p></li>
<li><p><a class="reference external" href="http://standards.freedesktop.org/basedir-spec/basedir-spec-latest.html">XDG Base Directory Specification</a></p></li>
<li><p><a class="reference external" href="http://developer.kde.org/documentation/tutorials/dot/servicemenus.html">Creating Konqueror Service Menus</a></p></li>
<li><p><a class="reference external" href="http://www.krusader.org/handbook/useractions.html">Krusader UserActions</a></p></li>
<li><p><a class="reference external" href="http://thunar.xfce.org/pwiki/documentation/custom_actions">Thunar Custom Actions</a></p></li>
</ul>
</div>
<div class="section" id="contributors">
<h2>Contributors<a class="headerlink" href="#contributors" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>Jonas Bähr</p></li>
<li><p>David Faure</p></li>
<li><p>Ted Gould</p></li>
<li><p>Hong Jen Yee “PCMan”</p></li>
<li><p>Michael Pyne</p></li>
<li><p>Liam R. E. Quin</p></li>
<li><p>Pierre Wieser</p></li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="menu.html" class="btn btn-neutral float-left" title="Global Menu" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="developer-tools.html" class="btn btn-neutral float-right" title="Developer Tools" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>